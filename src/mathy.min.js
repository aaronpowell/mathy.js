"use strict";(function(e){function r(e,n,i,a){if(e.type===c.placeholder&&e.value===n)return e.type=c.group,e.children.push(l(i,a)),!0;for(var u=0;e.children.length>u;u+=1)if(r(e.children[u],n,i,a))return!0;return!1}function n(e,r,n){var i=r.slice(0,e),a=r.slice(e+1).split(":"),u=new s(c.decision),t="";if("true"===i.toLowerCase())u.children.push(new s(c.boolean,!0));else if("false"===i.toLowerCase())u.children.push(new s(c.boolean,!1));else{var h;e=i.indexOf("=="),~e?(h=new s(c.equal),h.children.push(l(i.slice(0,e),n)),h.children.push(l(i.slice(e+2),n))):~(e=i.indexOf("!="))?(h=new s(c.notEqual),h.children.push(l(i.slice(0,e),n)),h.children.push(l(i.slice(e+2),n))):~(e=i.indexOf("<"))?(t=i.slice(e+1,e+2),"="===t?(h=new s(c.lessThanEqual),h.children.push(l(i.slice(0,e),n)),h.children.push(l(i.slice(e+2),n))):(h=new s(c.lessThan),h.children.push(l(i.slice(0,e),n)),h.children.push(l(i.slice(e+1),n)))):~(e=i.indexOf(">"))?(t=i.slice(e+1,e+2),"="===t?(h=new s(c.greaterThanEqual),h.children.push(l(i.slice(0,e),n)),h.children.push(l(i.slice(e+2),n))):(h=new s(c.greaterThan),h.children.push(l(i.slice(0,e),n)),h.children.push(l(i.slice(e+1),n)))):h=l(i,n),u.children.push(h)}return a.length?(u.children.push(l(a[0],n)),u.children.push(l(a[1],n))):(u.children.push(new s(c.value,!0)),u.children.push(new s(c.value,!1))),u}function l(e,i){var u,h,d,p;if("number"==typeof e)e+="";else if("string"!=typeof e)throw"The type "+typeof e+" is not supported as a derivation at the present";if(e=e.replace(a,""),u=e.lastIndexOf("("),~u){var o=u+e.slice(u).indexOf(")");h=e.slice(0,u),d=e.slice(u+1,o);var v=e.slice(o+1);p=new s(c.group);var f=++t;return p.children.push(l(h+"$"+f+v,i)),r(p.children[0],f,d,i),p}if(u=e.indexOf("?"),~u)return n(u,e,i);if(u=e.lastIndexOf("+"),~u)return p=new s(c.add),h=e.slice(0,u).trim(),h&&p.children.push(l(h,i)),d=e.slice(u+1).trim(),d&&p.children.push(l(d,i)),p;if(u=e.lastIndexOf("-"),~u)return p=new s(c.subtraction),h=e.slice(0,u).trim(),p.children.push(l(h,i)),d=e.slice(u+1).trim(),d&&p.children.push(l(d,i)),p;if(u=e.lastIndexOf("*"),~u)return p=new s(c.multiply),h=e.slice(0,u).trim(),h&&p.children.push(l(h,i)),d=e.slice(u+1).trim(),d&&p.children.push(l(d,i)),p;if(u=e.lastIndexOf("/"),~u)return p=new s(c.division),h=e.slice(0,u).trim(),h&&p.children.push(l(h,i)),d=e.slice(u+1).trim(),d&&p.children.push(l(d,i)),p;if(u=e.lastIndexOf("^"),~u)return p=new s(c.power),h=e.slice(0,u).trim(),h&&p.children.push(l(h,i)),d=e.slice(u+1).trim(),d&&p.children.push(l(d,i)),p;if("$"===e[0])return new s(c.placeholder,parseInt(e.slice(1),10));var m=i.filter(function(r){return r.name===e})[0];return m?(e=m.derivation,l(e,i)):(e=e.trim(),new s(c.value,isNaN(parseFloat(e))?"true"===e?!0:"false"===e?!1:e:parseFloat(e)))}function i(e){if(!e)return 0;for(var r=0;e.children.length>r;r+=1)i(e.children[r]);switch(e.type){case c.add:return e.value=e.children[0].value+e.children[1].value;case c.subtraction:return e.value=e.children[0].value-e.children[1].value;case c.multiply:return e.value=e.children[0].value*e.children[1].value;case c.division:return e.value=e.children[0].value/e.children[1].value;case c.group:return e.value=i(e.children[0]);case c.power:return e.value=Math.pow(e.children[0].value,e.children[1].value);case c.value:return e.value=e.source;case c.decision:return e.value=e.children[0].value?e.children[1].value:e.children[2].value;case c.boolean:return e.value;case c.equal:return e.value=e.children[0].value===e.children[1].value;case c.notEqual:return e.value=e.children[0].value!==e.children[1].value;case c.lessThanEqual:return e.value=e.children[0].value<=e.children[1].value;case c.lessThan:return e.value=e.children[0].value<e.children[1].value;case c.greaterThanEqual:return e.value=e.children[0].value>=e.children[1].value;case c.greaterThan:return e.value=e.children[0].value>e.children[1].value}return 0}var a=/\s+/gi,u=function(){function e(){for(var e=[],r=0;arguments.length-0>r;r++)e[r]=arguments[r+0];this.version="0.2.3",this.getRules=function(){return e}}return e.prototype.add=function(){for(var e=[],r=0;arguments.length-0>r;r++)e[r]=arguments[r+0];var n=this.getRules();n.push.apply(n,e)},e.prototype.process=function(){for(var e,r=this.getRules(),n=1===r.length?r:r.filter(function(e){return e.result},[]),a={},u=0;n.length>u;u+=1)e=l(n[u].derivation,r),a[u]=i(e),a[n[u].name]=e;return a},e}();e.Engine=u;var t=0,s=function(){function e(e,r){r===void 0&&(r=0),this.type=e,this.value=r,this.children=[],this.source=0,this.source=r}return e.prototype.toString=function(){var e="";switch(this.children[0]&&(e+=""+this.children[0]),this.type){case c.add:e+=" + ";break;case c.subtraction:e+=" -";break;case c.multiply:e+=" * ";break;case c.division:e+=" / ";break;case c.group:e+="(";break;case c.power:e+="^";break;case c.value:e+=this.value}return this.children[1]&&(e+=""+this.children[1]),e},e}();e.Calculation=s,function(e){e._map=[],e._map[0]="add",e.add=0,e._map[1]="subtraction",e.subtraction=1,e._map[2]="multiply",e.multiply=2,e._map[3]="division",e.division=3,e._map[4]="group",e.group=4,e._map[5]="power",e.power=5,e._map[6]="value",e.value=6,e._map[7]="placeholder",e.placeholder=7,e._map[8]="decision",e.decision=8,e._map[9]="boolean",e.boolean=9,e._map[10]="equal",e.equal=10,e._map[11]="notEqual",e.notEqual=11,e._map[12]="lessThanEqual",e.lessThanEqual=12,e._map[13]="lessThan",e.lessThan=13,e._map[14]="greaterThanEqual",e.greaterThanEqual=14,e._map[15]="greaterThan",e.greaterThan=15}(e.calculationType||(e.calculationType={}));var c=e.calculationType})(exports.mathy||(exports.mathy={}));var mathy=exports.mathy;
//@ sourceMappingURL=src/mathy.min.js.map